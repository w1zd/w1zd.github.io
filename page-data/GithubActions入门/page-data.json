{"componentChunkName":"component---src-templates-blog-post-tsx-content-file-path-content-blog-github-actionså…¥é—¨-md","path":"/GithubActionså…¥é—¨/","result":{"data":{"site":{"siteMetadata":{"title":"Wizard's Lair","postCopyright":true,"siteUrl":"https://wizd.dev","author":{"name":"w1zd"}}},"mdx":{"id":"398d7a9f-3f7b-5b30-b2ba-74b003b851bc","excerpt":"è¿™ä¸ªåšå®¢ç«™æ˜¯æˆ‘è‡ªå·±ç”¨ Gatsby éšä¾¿æ‹¼å‡‘äº†ä¸€ä¸‹é€ å‡ºæ¥çš„ï¼Œå‰å‡ å¤©å‘ç°å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œå¿ƒé‡Œè¿˜æ˜¯å¾ˆæ„§ç–šçš„ ğŸ¤£ï¼Œé‚£å°±æ›´æ–°ä¸€ç¯‡å§ã€‚ ä¹‹å‰ç”¨ Gatsby å†™åšå®¢è¦ä¹ˆæ˜¯åœ¨ OS ç³»ç»Ÿä¸‹ï¼Œè¦ä¹ˆæ˜¯åœ¨ Linux ç³»ç»Ÿä¸‹ï¼Œä»æ¥æ²¡ç”¨è¿‡ Windowsã€‚ä½†æ˜¯ç”±äºå·¥ä½œç¯å¢ƒçš„å˜åŒ–ï¼Œæ‰‹å¤´åªæœ‰ Windows å¯ç”¨â€¦","body":"\n![github-actions](https://raw.githubusercontent.com/w1zd/image-hosting/main/img/2022/05/10/13-43-12-ff8131d6e5212fdddaddb1f20be4e03e-github-actions-fd25c1.png)\n\nè¿™ä¸ªåšå®¢ç«™æ˜¯æˆ‘è‡ªå·±ç”¨ Gatsby éšä¾¿æ‹¼å‡‘äº†ä¸€ä¸‹é€ å‡ºæ¥çš„ï¼Œå‰å‡ å¤©å‘ç°å¥½ä¹…éƒ½æ²¡æœ‰æ›´æ–°åšå®¢äº†ï¼Œå¿ƒé‡Œè¿˜æ˜¯å¾ˆæ„§ç–šçš„ ğŸ¤£ï¼Œé‚£å°±æ›´æ–°ä¸€ç¯‡å§ã€‚\n\nä¹‹å‰ç”¨ Gatsby å†™åšå®¢è¦ä¹ˆæ˜¯åœ¨ OS ç³»ç»Ÿä¸‹ï¼Œè¦ä¹ˆæ˜¯åœ¨ Linux ç³»ç»Ÿä¸‹ï¼Œä»æ¥æ²¡ç”¨è¿‡ Windowsã€‚ä½†æ˜¯ç”±äºå·¥ä½œç¯å¢ƒçš„å˜åŒ–ï¼Œæ‰‹å¤´åªæœ‰ Windows å¯ç”¨ï¼Œè®²é“ç†è¿™ç§çº¯å‰ç«¯è¯¥æ²¡ä»€ä¹ˆå¹³å°é™åˆ¶ï¼Œä½†æ˜¯åœ¨æˆ‘ä¸€é€š `npm` å‘½ä»¤ä¹‹åï¼Œåšå®¢å¹¶æ²¡æœ‰æŒ‰ç…§æˆ‘çš„é¢„æœŸæ­£å¸¸è·‘èµ·æ¥ï¼Œè¿™é‡Œä¸å¯¹è¿™ä¸ªé—®é¢˜åšæ·±ç©¶ï¼ˆWindows æ–‡ä»¶è·¯å¾„å¤§å°å†™ä¸æ•æ„Ÿï¼Œè€Œä¸”ç›˜ç¬¦æ ¹ç›®å½•éƒ½æ˜¯å¤§å†™å­—æ¯ C D Eï¼Œä¼šå¯¼è‡´ Gatsby è„šæ‰‹æ¶éƒ¨åˆ†åŠŸèƒ½å¼‚å¸¸ï¼‰ã€‚\n\nç»è¿‡ä¸€ç•ªåŠªåŠ›ä¹‹åï¼Œç»ˆäºæ­£å¸¸è·‘èµ·æ¥äº†ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨çš„ Windows ç³»ç»Ÿé…ç½®ç‰¹åˆ«å·®ï¼ŒCPU åŠ¨ä¸åŠ¨å°±è¦é£™åˆ° 100%ï¼ŒGatsby æœ€ç»ˆç”Ÿæˆé™æ€ç«™ç‚¹çš„è¿‡ç¨‹åŠå…¶ç—›è‹¦ã€‚\n\nç”±äºæ‰€åœ¨ç½‘ç»œç¯å¢ƒçš„é—®é¢˜ï¼Œæœ€ç»ˆå°†ç”Ÿæˆçš„é™æ€å†…å®¹æ¨é€åˆ° Github Pages æœåŠ¡çš„è¿‡ç¨‹ä¹Ÿæ˜¯å¾ˆç³Ÿå¿ƒ ğŸ˜¢ã€‚\n\né‚å†³å®šï¼Œä½¿ç”¨ Github Actions è‡ªåŠ¨æ‰“åŒ…è‡ªåŠ¨éƒ¨ç½²ã€‚è¶æœ‰ç©ºèŠ±äº†ä¸€ä¸‹åˆæ—¶é—´ï¼ŒæŠŠ Github Lab ä¸­çš„ Github actions çš„å†…å®¹éƒ½è¿‡äº†ä¸€éï¼Œè¿™é‡Œå°±åšä¸ªç®€å•çš„è®°å½•ã€‚\n\n## Github Actions ç®€ä»‹\n\n> Automate, customize, and execute your software development workflows right in your repository with GitHub Actions. You can discover, create, and share actions to perform any job you'd like, including CI/CD, and combine actions in a completely customized workflow.\n\nGithub Actions å¯ä»¥ç²—ç•¥çš„ç†è§£ä¸ºé›†æˆåœ¨ Github ä¸­çš„ CI/CD æœåŠ¡ï¼Œ å’Œ Jenkinsã€Travis CI ç­‰ç±»ä¼¼ã€‚\n\n![ci/cd](https://raw.githubusercontent.com/w1zd/image-hosting/main/img/2022/05/10/13-43-29-98b9955a8eb015e58811a8ac81a195d3-cicd-749ce1.png)\n\nGithub Actions ç›®å‰å¯ä»¥ç”¨æ¥åšä»¥ä¸‹è¿™äº›äº‹æƒ…ï¼š\n\n- è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆæŒç»­é›†æˆï¼‰\n- æŒç»­äº¤ä»˜å’Œéƒ¨ç½²\n- è§¦å‘ Code Review\n- ç®¡ç†åˆ†æ”¯\n- åˆ†ç±» Issue å’Œ PR\n\nç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯ä¹‹å‰æˆ‘ä»¬éœ€è¦åœ¨æœ¬åœ°ç”µè„‘ä¸Šè¿›è¡Œçš„ `npm run build` `npm run test`ï¼Œéƒ½å¯ä»¥é€šè¿‡ä½¿ç”¨ Github Actions åœ¨äº‘å¹³å°ä¸­è¿›è¡Œï¼Œè€Œä¸”åœ¨æ‰“åŒ…å’Œæµ‹è¯•å®Œæˆä¹‹åï¼Œè¿˜èƒ½è‡ªåŠ¨å¸®ä½ è¿›è¡Œéƒ¨ç½²ã€‚\n\nè¿™å°±æ„å‘³ç€ï¼Œæˆ‘ä»¬ä¸éœ€è¦è‡ªå·±è´­ä¹°ä»¥åŠé…ç½®ç›¸å…³çš„æ„å»ºæœåŠ¡å™¨ï¼ŒGithub æä¾›äº†å…è´¹äº‘ç¯å¢ƒä¾›å¤§å®¶ä½¿ç”¨ã€‚è€Œä¸”ï¼Œç”±äºæ˜¯å’Œ Github é›†æˆçš„ï¼Œæ‰€æœ‰çš„å·¥ä½œæµéƒ½å¯ä»¥è®¾ç½® Github ç›¸å…³äº‹ä»¶è§¦å‘ï¼ˆpush, issues, label, pull request ç­‰ç­‰ï¼‰ã€‚\n\nåœ¨ Gihub ä¸­æœ‰ä¸€ä¸ª [Action å¸‚åœº](https://github.com/marketplace?type=actions)ï¼Œè¿˜æœ‰åˆ«äººæ•´ç†çš„ä¸€ä¸ª [Awesome Acitons](https://github.com/sdras/awesome-actions)ï¼Œé‡Œé¢æœ‰å¾ˆå¤šåˆ«äººå·²ç»å†™å¥½çš„ Actionï¼Œå¯ä»¥ç›´æ¥æ‹¿è¿‡æ¥ç”¨ï¼Œä¸è¦å¤ªçˆ½ã€‚\n\n## å¿«é€Ÿå…¥é—¨\n\n### å‡†å¤‡å·¥ä½œ\n\nä½ éœ€è¦ä¸€ä¸ª Github ä»“åº“ï¼Œæ–°å»ºä¸€ä¸ªä»“åº“ï¼Œæˆ–è€…ä½¿ç”¨ä¸€ä¸ªå·²æœ‰çš„ä»“åº“éƒ½å¯ä»¥ã€‚\n\n### åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ª workflow æ–‡ä»¶\n\nåœ¨ä½ çš„æœ¬åœ°ä»“åº“æ ¹ç›®å½•åˆ›å»º `.github/workflows` æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨ Windows æ“ä½œç³»ç»Ÿçš„åŒå­¦è‡ªè¡Œåˆ›å»ºï¼ŒLinux æ“ä½œç³»ç»Ÿçš„åŒå­¦å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤ã€‚ï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨æœ¬åœ°ä»“åº“ï¼Œç›´æ¥åœ¨ Github ç½‘é¡µä¸­è¿›è¡Œåˆ›å»ºæ–‡ä»¶çš„æ“ä½œï¼‰\n\n```bash\nmkdir -p .github/workflows\ncd .github/workflows\n```\n\nåˆ›å»ºæ–‡ä»¶ `your-first-workflow.yml`\n\n```bash\ntouch your-first-workflow.yml\n```\n\nå°†ä¸‹é¢çš„å†…å®¹å¤åˆ¶åˆ°ä½ çš„ `your-first-workflow.yml` æ–‡ä»¶ä¸­ï¼Œå¹¶ä¿å­˜ã€‚\n\n```yaml\nname: GitHub Actions Demo\non: [push]\njobs:\n  Explore-GitHub-Actions:\n    runs-on: ubuntu-latest\n    steps:\n      - run: echo \"ğŸ‰ ä½ çš„å·¥ä½œæµè¢« ${{ github.event_name }} äº‹ä»¶è‡ªåŠ¨è§¦å‘äº†.\"\n      - run: echo \"ğŸ§ æœ¬å·¥ä½œæµè¿è¡Œåœ¨ Github æ‰˜ç®¡çš„ ${{ runner.os }} æœåŠ¡å™¨ä¸Š!\"\n      - run: echo \"ğŸ” ä½ çš„åˆ†æ”¯åæ˜¯ ${{ github.ref }}ï¼Œä½ çš„ github ä»“åº“æ˜¯ ${{ github.repository }}.\"\n      - name: Check out repository code\n        uses: actions/checkout@v2\n      - run: echo \"ğŸ’¡ ä»“åº“ ${{ github.repository }} å·²ç»è¢«å…‹éš†åˆ° ubuntu äº†\"\n      - run: echo \"ğŸ–¥ï¸ å·¥ä½œæµå·²ç»å‡†å¤‡å¥½åœ¨ ubuntu ä¸Šå¯¹ä½ çš„ä»£ç è¿›è¡Œæµ‹è¯•äº†\"\n      - name: List files in the repository\n        run: |\n          ls ${{ github.workspace }}\n      - run: echo \"ğŸ å½“å‰å·¥ä½œæµçš„çŠ¶æ€æ˜¯ ${{ job.status }}.\"\n```\n\nå°†å½“å‰æ”¹åŠ¨æ¨é€åˆ°ä½ çš„ Github ä»“åº“ä¸­ã€‚ï¼ˆå¦‚æœä½ æ˜¯ Github é¡µé¢ç›´æ¥æ–°å»ºæ–‡ä»¶æ“ä½œçš„ç›´æ¥è·³è¿‡ï¼‰\n\n```bash\ngit add .\ngit push -u ä½ çš„ä»“åº“åœ°å€ master\n```\n\nç„¶åæ‰“å¼€ Github ä¸­çš„ Actions é¡µé¢ï¼Œä½ ä¼šå‘ç°ä½ çš„å·¥ä½œæµå·²ç»åœ¨è¿è¡Œäº†ã€‚\n\n## Github Actions åŸºæœ¬æ¦‚å¿µ\n\n- workflow(å·¥ä½œæµ)ï¼šæ¯ä¸ª workflow æ–‡ä»¶å°±ä»£è¡¨ä¸€ä¸ªå·¥ä½œæµï¼Œä¼šåœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹è§¦å‘ã€‚\n- jobs(å·¥ä½œ)ï¼šä¸€ä¸ªå·¥ä½œæµä¸­å¯ä»¥åŒ…å«å¾ˆå¤šå·¥ä½œï¼Œå­—é¢æ„æ€å¾ˆå¥½ç†è§£ï¼ˆä¹”å¸ƒæ–¯å“ˆå“ˆå“ˆï¼‰\n- steps(æ­¥éª¤)ï¼šæ¯ä¸ªå·¥ä½œå¯ä»¥æœ‰å¾ˆå¤šæ­¥éª¤ç»„æˆ\n- action(è¡Œä¸º)ï¼šæ¯ä¸ªæ­¥éª¤ä¸­å¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªè¡Œä¸ºï¼ˆæˆ–è€…å«å‘½ä»¤æ›´å¥½ï¼Ÿå®åœ¨ä¸çŸ¥é“æ€ä¹ˆç¿»è¯‘æ›´å¥½ ğŸ˜…ï¼‰\n\n## workflow æ–‡ä»¶è¯¦è§£\n\n### name\n\nå·¥ä½œæµçš„åç§°ï¼Œä¼šå±•ç¤ºåœ¨ä½ çš„ Gihub Actions é¡µé¢ä¸­ï¼Œ å¦‚æœä½ ä¸ç»™åå­—ï¼Œé»˜è®¤ä¼šä½¿ç”¨ä½ çš„æ–‡ä»¶è·¯å¾„\n\næ¯”å¦‚å¿«é€Ÿå…¥é—¨ä¸­ï¼Œæˆ‘ä»¬çš„å·¥ä½œæµåç§°å°±æ˜¯ `GitHub Actions Demo`\n\n```yaml\nname: GitHub Actions Demo\n```\n\n### on\n\nè§¦å‘ä½ å·¥ä½œæµçš„ Gihub äº‹ä»¶åç§°ï¼Œå¯ä»¥æ˜¯å•ä¸ªäº‹ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸ªäº‹ä»¶æ•°ç»„ã€‚\n[èƒ½è§¦å‘å·¥ä½œçš„æµçš„äº‹ä»¶çœ‹è¿™é‡Œ](https://docs.github.com/en/actions/reference/events-that-trigger-workflows)\n\nå¿«é€Ÿå…¥é—¨ä¸­ï¼Œæˆ‘ä»¬çš„è®¾ç½®çš„è§¦å‘äº‹ä»¶æ˜¯ `push`ï¼Œé‚£å°±æ„å‘³ç€ï¼Œå½“æˆ‘ä»¬å‘ Github ä»“åº“ä¸­æ¨é€å†…å®¹çš„æ—¶å€™ï¼Œå°±ä¼šè‡ªåŠ¨è§¦å‘æˆ‘ä»¬çš„å·¥ä½œæµã€‚\n\n```yaml\non: [push]\n# ä½ ä¹Ÿå¯ä»¥ç”¨å¦‚ä¸‹çš„å½¢å¼\non: push\n```\n\næˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾ç½®åœ¨æŒ‡å®šçš„åˆ†æ”¯ä¸Š push æ—¶æ‰è§¦å‘\n\n```yaml\non:\n  push:\n    branches:\n      - master\n```\n\næˆ‘ä»¬è¿˜å¯ä»¥è®¾ç½®è®©å·¥ä½œæµå®šæ—¶æ‰§è¡Œï¼Œè¿™å°±å¾ˆå¼ºäº†ï¼æ¯”å¦‚ä½ å†™ä¸ªçˆ¬è™«ï¼Œå®šæ—¶å»è·‘ï¼Œå½“ç„¶è¿™å±äºè–…ç¾Šæ¯›æ“ä½œï¼Œä¹‹å‰å¥½åƒæœ‰ä¸å°‘äººå› ä¸ºä¸æ˜åŸå› è¢«å–æ¶ˆäº†ä½¿ç”¨èµ„æ ¼ã€‚æ­£å¸¸æƒ…å†µä¸‹ä¸ä¼šæœ‰è¿™æ ·çš„äº‹æƒ…ï¼Œå®˜æ–¹çš„é™åˆ¶å¯ä»¥çœ‹çœ‹[è¿™é‡Œ](https://docs.github.com/en/actions/reference/usage-limits-billing-and-administration)ã€‚\n\n```yaml\non:\n  schedule:\n    - cron: \"*/30 5,17 * * *\"\n```\n\nä¸Šé¢çš„å®šæ—¶è®¡åˆ’æ˜¯ï¼Œåœ¨æ¯å¤©çš„ `5:30` å’Œ `17:30` è‡ªåŠ¨æ‰§è¡Œï¼Œè¿™é‡Œä½¿ç”¨çš„æ—¶é—´è®¡åˆ’æ˜¯[POSIX cron syntax](https://pubs.opengroup.org/onlinepubs/9699919799/utilities/crontab.html#tag_20_25_07)ï¼Œæ„Ÿå…´è¶£çš„åŒå­¦è‡ªè¡Œäº†è§£ã€‚\n\n### jobs\n\nä¸Šé¢å…³äºå·¥ä½œæµæ•´ä½“çš„é…ç½®åŸºæœ¬ ok äº†ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å…·ä½“çš„å·¥ä½œæµé‡Œé¢è¦åšçš„äº‹æƒ…äº†ã€‚`jobs` å°±æ˜¯ç”¨æ¥è®¾ç½®å½“å‰å·¥ä½œæµä¸­å…·ä½“çš„å·¥ä½œå†…å®¹çš„ã€‚\n\næ¯ä¸ªå·¥ä½œéœ€è¦æœ‰è‡ªå·±çš„ `id`ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸€ä¸ª `name`:\n\n```yaml\njobs:\n  job1: # è¿™é‡Œ job1 å°±æ˜¯ id\n    name: This is the job1 # è¿™é‡Œæ˜¯ job çš„ name\n  job2:\n    name: My second job\n```\n\nå½“æœ‰å¤šé¡¹å·¥ä½œçš„æ—¶å€™ï¼Œé¿å…ä¸äº†çš„ä¼šå‡ºç°å·¥ä½œé¡¹ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œæ¯”å¦‚ `job2` è¦åœ¨ `job1` å®Œæˆä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦ä¸º `job2` è®¾ç½® `needs` é€‰é¡¹ï¼š\n\n```yaml\njobs:\n  job1: # è¿™é‡Œ job1 å°±æ˜¯ id\n    name: This is the job1 # è¿™é‡Œæ˜¯ job çš„ name\n  job2:\n    name: My second job\n    needs: job1 # æ³¨æ„è¿™é‡Œä½¿ç”¨çš„æ˜¯ idï¼Œä¸æ˜¯ name\n```\n\nåœ¨æ‰§è¡Œæ„å»ºä»»åŠ¡æˆ–è€…æµ‹è¯•ä»»åŠ¡æ—¶ï¼Œéœ€è¦æŒ‡å®šå¯¹åº”çš„æ‰§è¡Œç¯å¢ƒï¼Œä¹Ÿå°±æ˜¯å¯¹åº”çš„æ“ä½œç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `runs-on` æ¥æŒ‡å®šå½“å‰ `jobs` éœ€è¦æ‰§è¡Œçš„ç¯å¢ƒã€‚\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n```\n\nç›®å‰ Github èƒ½æä¾›çš„ç¯å¢ƒå¦‚ä¸‹ï¼š\n\n| Virtual environment  | YAML workflow label            |\n| -------------------- | ------------------------------ |\n| Windows Server 2019  | windows-latest or windows-2019 |\n| Ubuntu 20.04         | ubuntu-latest or ubuntu-20.04  |\n| Ubuntu 18.04         | ubuntu-18.04                   |\n| Ubuntu 16.04         | ubuntu-16.04                   |\n| macOS Big Sur 11.0   | macos-11.0                     |\n| macOS Catalina 10.15 | macos-latest or macos-10.15    |\n\næœ‰çš„æ—¶å€™éœ€è¦åœ¨ä¸åŒç¯å¢ƒä¸‹æµ‹è¯•ä¸€å¥—ä»£ç ï¼Œæœ‰åŒå­¦å¯èƒ½ä¼šæƒ³ï¼Œé‚£æˆ‘æ˜¯ä¸æ˜¯è¦æ¥å¤šä¸ª `job` æ¥åœ¨ä¸åŒçš„ç¯å¢ƒä¸­è¿›è¡Œæ“ä½œã€‚å…¶å®ä¸éœ€è¦ï¼ŒGithub Action å¸®æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨ `strategy`ï¼Œå°±å¯ä»¥è®©å½“å‰ `job` åœ¨ä¸åŒç¯å¢ƒä¸­è¿è¡Œã€‚\n\nä¸‹é¢çš„é…ç½®å°±å¯ä»¥è®©æˆ‘ä»¬åœ¨ `unbuntu-latest` å’Œ `windows-2016` ä¸­åˆ†åˆ«æ‰§è¡Œ `job1`ï¼Œè€Œä¸”ï¼è€Œä¸”ï¼è€Œä¸”ï¼ä¼šåˆ†åˆ«åœ¨ `node 12.x` å’Œ `node 14.x` çš„ç‰ˆæœ¬ä¸­æ‰§è¡Œã€‚ ä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ `job1` æœ€ç»ˆä¼šæ‰§è¡Œ 4 æ¬¡å“¦ï¼\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        os: [ubuntu-latest, windows-2016]\n        node-version: [12.x, 14.x]\n```\n\n### steps\n\næ¯ä¸ª `job` ä¸­éœ€è¦è¿›è¡Œçš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ `steps` æ¥å®šä¹‰ã€‚\n\n`step` ä¸­ä¹Ÿæœ‰ `name` æ¥å®šä¹‰æ¯ä¸€æ­¥çš„åç§°ï¼Œç”¨æ¥å£°æ˜è¿™ä¸€æ­¥åœ¨åšä»€ä¹ˆã€‚\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        os: [ubuntu-latest, windows-2016]\n        node-version: [12.x, 14.x]\n    steps:\n      - name: Print a greeting\n```\n\n`step` ä¸­æœ€å…³é”®çš„æ˜¯ `run`ï¼Œç”¨æ¥æ‰§è¡Œå…·ä½“çš„å‘½ä»¤ã€‚\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        os: [ubuntu-latest, windows-2016]\n        node-version: [12.x, 14.x]\n    steps:\n      - name: Print a greeting\n        run: |\n          echo Hello World.\n```\n\n`step` ä¸­è¿˜å¯ä»¥æ·»åŠ ç¯å¢ƒå˜é‡ `env`ï¼Œè¿™æ ·åœ¨æ‰§è¡Œçš„å‘½ä»¤ä¸­å¯ä»¥ä½¿ç”¨è¿™äº›ç¯å¢ƒå˜é‡ï¼Œå°±åƒä¸‹é¢è¿™æ ·ã€‚\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        os: [ubuntu-latest, windows-2016]\n        node-version: [12.x, 14.x]\n    steps:\n      - name: Print a greeting\n        env:\n          MY_VAR: Hi there! My name is\n          FIRST_NAME: Mona\n          MIDDLE_NAME: The\n          LAST_NAME: Octocat\n        run: |\n          echo $MY_VAR $FIRST_NAME $MIDDLE_NAME $LAST_NAME.\n```\n\né™¤äº†æ‰§è¡ŒæŒ‡å®šçš„å‘½ä»¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ `uses` åœ¨ `step` ä¸­è°ƒç”¨ `action`ï¼ˆ`aciton`å¯ä»¥è‡ªå·±å†™ï¼Œä¹Ÿå¯ä»¥å»å¸‚åœºæ‰¾ï¼‰ã€‚\n\n```yaml\njobs:\n  job1:\n    name: This is the job1\n    runs-on: ubuntu-latest\n    strategy:\n      matrix:\n        os: [ubuntu-latest, windows-2016]\n        node-version: [12.x, 14.x]\n    steps:\n      - uses: actions/checkout@v2 # è¿™é‡Œå°±æ˜¯ä½¿ç”¨å¸‚åœºä¸­æä¾›çš„ action å°†å½“å‰çš„ä»“åº“ä»£ç æ£€å‡ºåˆ°è™šæ‹Ÿæœº\n      - name: Use Node.js ${{ matrix.node-version }}\n        uses: ./.github/actions/setup-node # è¿™é‡Œæ˜¯ä½¿ç”¨è‡ªå·±å†™çš„ action å®‰è£… node ç¯å¢ƒï¼ˆå®é™…ä¸å­˜åœ¨ï¼Œåªæ˜¯ç»™å¤§å®¶æ¼”ç¤ºå†™æ³•ï¼Œå®é™…ä½¿ç”¨çš„è¿˜æ˜¯å¸‚åœºæä¾›çš„ actions/setup-node@v1ï¼‰\n        with: # with ä¸ºè¿™ä¸ª action æä¾›ç›¸åº”çš„å‚æ•°\n          node-version: ${{ matrix.node-version }}\n      - name: npm install, and test\n        run: |\n          npm install\n          npm test\n```\n\n## ä½¿ç”¨ Github Actions å‘å¸ƒ Gatsby åˆ° Github Pages\n\næœ¬æ¥æ‰“ç®—è‡ªå·±å†™ä¸€ä¸ªå‘å¸ƒçš„ actionï¼Œç»“æœå‘ç°å·²ç»æœ‰äººå·²ç»é€ å¥½äº†è½®å­ï¼Œé‚£æˆ‘ä»¬å°±åœ¨å·¨äººè‚©ä¸Šç©ç©å§ã€‚\n\nä¸‹é¢æ˜¯æˆ‘å®Œæ•´çš„ workflow æ–‡ä»¶ã€‚\n\n```yaml\nname: Gatsby Publish\n\non:\n  push:\n    branches:\n      - master # master åˆ†æ”¯æ˜¯æˆ‘å¾— Gatsby ä»£ç \n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v1 # è¿™é‡Œè¿˜æ˜¯ä½¿ç”¨å¸‚åœºæä¾›çš„ action æ£€å‡ºä»£ç åˆ°è™šæ‹Ÿæœº\n      - uses: enriikke/gatsby-gh-pages-action@v2 # è¿™é‡Œå°±æ˜¯å·¨äººé€ å¥½å¾—è½®å­ï¼Œå¯ä»¥æ„å»º Gatsby é™æ€é¡µé¢ï¼Œå¹¶ä¸”å‘å¸ƒåˆ° Github Pages\n        with:\n          access-token: ${{ secrets.ACCESS_TOKEN }} # æˆ‘ä»¬éœ€è¦æä¾›ç›¸åº”çš„å‚æ•°ï¼Œè¿™ä¸ª token æä¾›æˆ‘ä¼šåœ¨ä¸‹é¢è®²åˆ°\n          deploy-branch: page # è¿™é‡Œæ˜¯æŒ‡å®šæä¾› Github Pages çš„åˆ†æ”¯ï¼Œæœ€ç»ˆæ„ä»¶å¥½çš„é™æ€é¡µé¢å°±ä¼šå‘å¸ƒåˆ°è¿™ä¸ªåˆ†æ”¯\n```\n\næ•´ä¸ª workflow è¿è¡Œæµç¨‹å¦‚ä¸‹ï¼š\n\n1. æœ¬åœ°å†™å¥½æ–‡ç« åï¼Œ`push` åˆ° github\n2. ç”±äº workflow ä¸­ `on: push` çš„å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨è§¦å‘è¯¥å·¥ä½œæµ\n3. å½“å‰ workflow åªæœ‰ä¸€ä¸ªjobï¼Œåœ¨è™šæ‹Ÿæœºç¯å¢ƒ ubuntu-latest ä¸­\n4. ç¬¬ä¸€æ­¥ä½¿ç”¨ `actions/checkout` è·å–æºç \n5. ç¬¬äºŒæ­¥ä½¿ç”¨ `enriikke/gatsby-gh-pages-action@v2` æ„å»ºé™æ€ç«™ç‚¹å¹¶è¿›è¡Œéƒ¨ç½²\n\nä¹Ÿå°±æ˜¯åœ¨æˆ‘ä»¬æ¯æ¬¡æœ¬åœ°å†™å¥½ Markdown æ–‡ç« ä¹‹åï¼Œæ¨é€åˆ° Githubï¼Œæˆ‘ä»¬çš„ `workflow` å°±ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”Ÿæˆé™æ€é¡µé¢ï¼Œå¹¶ä¸”å‘å¸ƒåˆ° Github Pagesã€‚\n\n### $\\{\\{ secrets.ACCESS_TOKEN \\}\\}\n\nåœ¨ä¸Šé¢çš„ `steps` ç¬¬äºŒæ­¥ä¸­ï¼Œæˆ‘ä»¬ç”¨åˆ°äº†ä¸€ä¸ª `${{ secrets.ACCESS_TOKEN }}`ï¼Œ è¿™æ˜¯ç”±äºè¯¥ `action` éœ€è¦å°†æ„ä»¶å¥½çš„é™æ€é¡µé¢ `push` åˆ°æˆ‘ä»¬çš„ `page` åˆ†æ”¯ï¼Œæ‰€ä»¥éœ€è¦ Github çš„è®¿é—®æƒé™ï¼Œæˆ‘ä»¬éœ€è¦[è‡ªå·±ç”Ÿæˆ `Access_Token`](https://docs.github.com/en/github/authenticating-to-github/creating-a-personal-access-token)ï¼Œå¹¶åœ¨é¡¹ç›®è®¾ç½®é¡µé¢ä¸­æä¾›ã€‚\n\n![access_token](https://raw.githubusercontent.com/w1zd/image-hosting/main/img/2022/05/10/13-43-36-677e12d2d7b9db2aaab9fb3070b7329d-access_token-aba4e5.png)\n\n## æ€»ç»“\n\næœ¬æ–‡åªæ˜¯è®²è§£äº†ä¸€äº›æ—¥å¸¸ç”¨æ³•ï¼Œå…³äº Github Actions æ›´æ·±å±‚æ¬¡çš„å­¦ä¹ ï¼Œå¤§å®¶å¯ä»¥å‚è€ƒ[å®˜ç½‘æ–‡æ¡£](https://docs.github.com/en/actions/learn-github-actions)ã€‚\n\nGithub Actions ä½¿å¾—å®šåˆ¶å¼€å‘å·¥ä½œæµå¦‚æ­¤ç®€å•ï¼Œåœ¨ DevOps æ–¹é¢è¿˜æœ‰å¾ˆå¤šçš„å¯èƒ½æ€§ï¼Œå¿…ç„¶ä¼šæ˜¯æ—¥åå‘å±•çš„è¶‹åŠ¿ï¼ˆå½“ç„¶æˆ‘æ˜¯è¯´å®ƒè¿™ç§æ¨¡å¼ï¼Œæ¯•ç«Ÿï¼Œå®ƒæ˜¯è¦æ”¶é’±çš„ğŸ¤£ ğŸ¤£ ğŸ¤£ï¼‰ã€‚\n\n","fields":{"slug":"/GithubActionså…¥é—¨/"},"frontmatter":{"title":"GitHub Actions å…¥é—¨","date":"April 12, 2021","description":"å€ŸåŠ© GitHub Actionsï¼Œå¯ä»¥ç›´æ¥ä» GitHub æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ä»£ç ï¼Œè½»æ¾å®ç°æ‰€æœ‰è½¯ä»¶å·¥ä½œæµç¨‹çš„è‡ªåŠ¨åŒ–ã€‚","categories":["æŠ€æœ¯æ–‡ç« "],"tags":["DevOps","Github"],"toc":null}}},"pageContext":{"slug":"/GithubActionså…¥é—¨/","previous":{"internal":{"contentFilePath":"/home/runner/work/w1zd.github.io/w1zd.github.io/content/blog/HTTPä¼šè¯æœºåˆ¶åŠJWTåŸç†æµ…æ.md"},"fields":{"slug":"/HTTPä¼šè¯æœºåˆ¶åŠJWTåŸç†æµ…æ/"},"frontmatter":{"title":"HTTP ä¼šè¯æœºåˆ¶åŠ JWT æ·±å…¥æµ…å‡º"}},"next":{"internal":{"contentFilePath":"/home/runner/work/w1zd.github.io/w1zd.github.io/content/blog/Prismjs-Highlight-Supported-Language-List.md"},"fields":{"slug":"/Prismjs-Highlight-Supported-Language-List/"},"frontmatter":{"title":"Prismjs ä»£ç é«˜äº®æ”¯æŒè¯­è¨€åˆ—è¡¨"}},"frontmatter":{"title":"GitHub Actions å…¥é—¨","date":"2021-04-12T11:11:23.284Z","tags":["DevOps","Github"],"categories":["æŠ€æœ¯æ–‡ç« "],"description":"å€ŸåŠ© GitHub Actionsï¼Œå¯ä»¥ç›´æ¥ä» GitHub æ„å»ºã€æµ‹è¯•å’Œéƒ¨ç½²ä»£ç ï¼Œè½»æ¾å®ç°æ‰€æœ‰è½¯ä»¶å·¥ä½œæµç¨‹çš„è‡ªåŠ¨åŒ–ã€‚"}}},"staticQueryHashes":["2786614800","3000541721","3828236571"],"slicesMap":{}}